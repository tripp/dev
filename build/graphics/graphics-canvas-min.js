YUI.add("graphics-canvas",function(e){function d(f){this.initializer.apply(this,arguments);}d.prototype={getXY:function(){var f=e.one(this.node),g=f.getXY();return g;},autoSize:true,initializer:function(g){g=g||{};var f=g.width||0,i=g.height||0;this.node=e.config.doc.createElement("div");this.setSize(f,i);if(g.render){this.render(g.render);}},setSize:function(f,g){if(this.autoSize){if(f>this.node.getAttribute("width")){this.node.style.width=f+"px";this.node.setAttribute("width",f);}if(g>this.node.getAttribute("height")){this.node.style.height=g+"px";this.node.setAttribute("height",g);}}},_trackSize:function(f,g){if(f>this._width){this._width=f;}if(g>this._height){this._height=g;}this.setSize(f,g);},setPosition:function(f,g){this.node.style.left=f+"px";this.node.style.top=g+"px";},render:function(j){var k=this.node,f=e.one(j),g=f.get("width")||f.get("offsetWidth"),i=f.get("height")||f.get("offsetHeight");k.style.display="block";k.style.position="absolute";k.style.left=e.one(k).getStyle("left");k.style.top=e.one(k).getStyle("top");k.style.pointerEvents="visiblePainted";f=f||e.config.doc.body;f.appendChild(this.node);this.setSize(g,i);return this;},toggleVisible:function(f){this.node.style.visibility=f?"visible":"hidden";},addShape:function(f){var g=f.get("node");f.set("graphic",this);this.node.appendChild(g);if(!this._graphicsList){this._graphicsList=[];}this._graphicsList.push(g);},destroy:function(){this._removeChildren(this.node);if(this.node&&this.node.parentNode){this.node.parentNode.removeChild(this.node);}},_removeChildren:function(f){if(f.hasChildNodes()){var g;while(f.firstChild){g=f.firstChild;this._removeChildren(g);f.removeChild(g);}}}};e.Graphic=d;var b;function c(){if(!b){b=e.config.doc.createElement("div");}b.style.height=0;b.style.width=0;b.style.overflow="hidden";e.config.doc.documentElement.appendChild(b);return b;}function a(){}a.prototype={_reHex:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,_2RGBA:function(g,f){f=(f!==undefined)?f:1;if(this._reHex.exec(g)){g="rgba("+[parseInt(RegExp.$1,16),parseInt(RegExp.$2,16),parseInt(RegExp.$3,16)].join(",")+","+f+")";}return g;},_2RGB:function(g){var f=c();f.style.background=g;return f.style.backgroundColor;},setSize:function(f,g){if(this.get("autoSize")){if(f>this.node.getAttribute("width")){this.node.style.width=f+"px";this.node.setAttribute("width",f);}if(g>this.node.getAttribute("height")){this.node.style.height=g+"px";this.node.setAttribute("height",g);}}},_updatePosition:function(f,g){this._updateCoords(f,g);if(f<=this._left){this._left=f;}else{if(f>=this._right){this._right=f;}}if(g<=this._top){this._top=g;}else{if(g>=this._bottom){this._bottom=g;}}this._width=this._right-this._left;this._height=this._bottom-this._top;},_updateCoords:function(f,g){this._xcoords.push(f);this._ycoords.push(g);},_clearAndUpdateCoords:function(){var f=this._xcoords.pop()||0,g=this._ycoords.pop()||0;this._updateCoords(f,g);},_updateNodePosition:function(){var g=this.get("node"),f=this.get("x"),h=this.get("y");g.style.position="absolute";g.style.left=(f+this._left)+"px";g.style.top=(h+this._top)+"px";},_methods:null,_properties:null,_updateDrawingQueue:function(f){if(!this._methods){this._methods=[];}this._methods.push(f);},lineTo:function(l,k,h){var g=arguments,j,f;if(!this._lineToMethods){this._lineToMethods=[];}if(typeof l==="string"||typeof l==="number"){g=[[l,k]];}for(j=0,f=g.length;j<f;++j){this._updateDrawingQueue(["lineTo",g[j][0],g[j][1]]);this._lineToMethods[this._lineToMethods.length]=this._methods[this._methods.length-1];this._updateShapeProps.apply(this,g[j]);this._updatePosition(g[j][0],g[j][1]);}this._drawingComplete=false;return this;},moveTo:function(f,g){this._updateDrawingQueue(["moveTo",f,g]);this._updateShapeProps(f,g);this._updatePosition(f,g);this._drawingComplete=false;return this;},curveTo:function(i,g,n,m,l,k){var j,h,f,o;this._updateDrawingQueue(["bezierCurveTo",i,g,n,m,l,k]);this._drawingComplete=false;this._updateShapeProps(l,k);j=Math.max(l,Math.max(i,n));h=Math.max(k,Math.max(g,m));f=Math.min(l,Math.min(i,n));o=Math.min(k,Math.min(g,m));this._updatePosition(j,h);this._updatePosition(f,o);return this;},quadraticCurveTo:function(j,i,f,m){var h,g,l,k;this._updateDrawingQueue(["quadraticCurveTo",j,i,f,m]);this._drawingComplete=false;this._updateShapeProps(f,m);h=Math.max(f,j);g=Math.max(m,i);l=Math.min(f,j);k=Math.min(m,i);this._updatePosition(h,g);this._updatePosition(l,k);return this;},drawCircle:function(g,k,f){var i=0,h=2*Math.PI,j=f*2;this._shape={x:g,y:k,w:j,h:j};this._drawingComplete=false;this._updatePosition(g+j,k+j);this._updateDrawingQueue(["arc",g+f,k+f,f,i,h,false]);return this;},drawEllipse:function(s,q,t,B){this._shape={x:s,y:q,w:t,h:B};if(this._stroke&&this._strokeWeight>0){t-=this._strokeWeight*2;B-=this._strokeWeight*2;s+=this._strokeWeight;q+=this._strokeWeight;}var v=8,n=-(45/180)*Math.PI,D=0,m,j=t/2,k=B/2,z=0,p=s+j,o=q+k,u,r,C,A,g,f;u=p+Math.cos(0)*j;r=o+Math.sin(0)*k;this.moveTo(u,r);for(;z<v;z++){D+=n;m=D-(n/2);C=p+Math.cos(D)*j;A=o+Math.sin(D)*k;g=p+Math.cos(m)*(j/Math.cos(n/2));f=o+Math.sin(m)*(k/Math.cos(n/2));this.quadraticCurveTo(g,f,C,A);}this._trackPos(s,q);this._trackSize(s+t,q+B);return this;},drawRect:function(f,j,g,i){this._shape={x:f,y:j,w:g,h:i};this._drawingComplete=false;this.moveTo(f,j);this.lineTo(f+g,j);this.lineTo(f+g,j+i);this.lineTo(f,j+i);this.lineTo(f,j);return this;},drawRoundRect:function(f,l,g,j,i,k){this._shape={x:f,y:l,w:g,h:j};this._drawingComplete=false;this._updateDrawingQueue(["moveTo",f,l+k]);this._updateDrawingQueue(["lineTo",f,l+j-k]);this._updateDrawingQueue(["quadraticCurveTo",f,l+j,f+i,l+j]);this._updateDrawingQueue(["lineTo",f+g-i,l+j]);this._updateDrawingQueue(["quadraticCurveTo",f+g,l+j,f+g,l+j-k]);this._updateDrawingQueue(["lineTo",f+g,l+k]);this._updateDrawingQueue(["quadraticCurveTo",f+g,l,f+g-i,l]);this._updateDrawingQueue(["lineTo",f+i,l]);this._updateDrawingQueue(["quadraticCurveTo",f,l,f,l+k]);this._trackPos(f,l);this._trackSize(g,j);this._paint();return this;
},drawWedge:function(j){var q=j.x,o=j.y,u=j.startAngle,n=j.arc,h=j.radius,k=j.yRadius,t,s,m,A,l,r,p,z,w,g,f,v=0;this._drawingComplete=false;this._updateRenderQueue(["moveTo",q,o]);k=k||h;if(Math.abs(n)>360){n=360;}t=Math.ceil(Math.abs(n)/45);s=n/t;m=-(s/180)*Math.PI;A=-(u/180)*Math.PI;if(t>0){r=q+Math.cos(u/180*Math.PI)*h;p=o+Math.sin(-u/180*Math.PI)*k;this.lineTo(r,p);for(;v<t;++v){A+=m;l=A-(m/2);z=q+Math.cos(A)*h;w=o+Math.sin(A)*k;g=q+Math.cos(l)*(h/Math.cos(m/2));f=o+Math.sin(l)*(k/Math.cos(m/2));this._updateRenderQueue(["quadraticCurveTo",g,f,z,w]);}this._updateRenderQueue(["lineTo",q,o]);}this._trackPos(q,o);this._trackSize(h,h);this._paint();},end:function(){this._paint();return this;},_getLinearGradient:function(){var u=e.Lang.isNumber,C=this.get("fill"),p=C.stops,m,B,A,D=0,E=p.length,f,s=0,q=0,t=this.get("width"),F=this.get("height"),z=C.rotation,H,G,l,j,k=s+t/2,g=q+F/2,o,n=Math.PI/180,v=parseFloat(parseFloat(Math.tan(z*n)).toFixed(8));if(Math.abs(v)*t/2>=F/2){if(z<180){l=q;j=q+F;}else{l=q+F;j=q;}H=k-((g-l)/v);G=k-((g-j)/v);}else{if(z>90&&z<270){H=s+t;G=s;}else{H=s;G=s+t;}l=((v*(k-H))-g)*-1;j=((v*(k-G))-g)*-1;}f=this._context.createLinearGradient(H,l,G,j);for(;D<E;++D){A=p[D];m=A.opacity;B=A.color;o=A.offset;if(u(m)){m=Math.max(0,Math.min(1,m));B=this._2RGBA(B,m);}else{B=this._2RGB(B);}o=A.offset||D/(E-1);f.addColorStop(o,B);}return f;},_getRadialGradient:function(){var A=e.Lang.isNumber,G=this.get("fill"),B=G.r,o=G.fx,m=G.fy,q=G.stops,n,D,C,H=0,J=q.length,g,u=0,t=0,v=this.get("width"),K=this.get("height"),L,I,l,k,F,E,f,z,M,N,p,s,j;E=u+v/2;f=t+K/2;L=v*o;l=K*m;I=u+v/2;k=t+K/2;F=v*B;N=Math.sqrt(Math.pow(Math.abs(E-L),2)+Math.pow(Math.abs(f-l),2));if(N>=F){s=N/F;if(s===1){s=1.01;}z=(L-E)/s;M=(l-f)/s;z=z>0?Math.floor(z):Math.ceil(z);M=M>0?Math.floor(M):Math.ceil(M);L=E+z;l=f+M;}if(B>=0.5){g=this._context.createRadialGradient(L,l,B,I,k,B*v);j=1;}else{g=this._context.createRadialGradient(L,l,B,I,k,v/2);j=B*2;}for(;H<J;++H){C=q[H];n=C.opacity;D=C.color;p=C.offset;if(A(n)){n=Math.max(0,Math.min(1,n));D=this._2RGBA(D,n);}else{D=this._2RGB(D);}p=C.offset||H/(J-1);p*=j;if(p<=1){g.addColorStop(p,D);}}return g;},_initProps:function(){this._methods=[];this._lineToMethods=[];this._xcoords=[0];this._ycoords=[0];this._width=0;this._height=0;this._left=0;this._top=0;this._right=0;this._bottom=0;this._x=0;this._y=0;},_drawingComplete:false,_createGraphic:function(f){var g=e.config.doc.createElement("canvas");return g;},_trackSize:function(f,g){if(f>this._width){this._width=f;}if(g>this._height){this._height=g;}},_trackPos:function(f,g){if(f>this._x){this._x=f;}if(g>this._y){this._y=g;}},_updateShapeProps:function(f,j){var g,i;if(!this._shape){this._shape={};}if(!this._shape.x){this._shape.x=f;}else{this._shape.x=Math.min(this._shape.x,f);}if(!this._shape.y){this._shape.y=j;}else{this._shape.y=Math.min(this._shape.y,j);}g=Math.abs(f-this._shape.x);if(!this._shape.w){this._shape.w=g;}else{this._shape.w=Math.max(g,this._shape.w);}i=Math.abs(j-this._shape.y);if(!this._shape.h){this._shape.h=i;}else{this._shape.h=Math.max(i,this._shape.h);}}};e.Drawing=a;e.Shape=e.Base.create("shape",e.Base,[e.Drawing],{addClass:function(f){var g=e.one(this.get("node"));g.addClass(f);},removeClass:function(f){var g=e.one(this.get("node"));g.removeClass(f);},getXY:function(){var i=this.get("graphic"),g=i.getXY(),f=this.get("x"),h=this.get("y");return[g[0]+f,g[1]+h];},setXY:function(g){var h=this.get("graphic"),f=h.getXY();this.set("x",g[0]-f[0]);this.set("y",g[1]-f[1]);},contains:function(f){return f===this;},test:function(f){return e.one(this.get("node")).test(f);},_getDefaultFill:function(){return{type:"solid",cx:0.5,cy:0.5,fx:0.5,fy:0.5,r:0.5};},_getDefaultStroke:function(){return{weight:1,dashstyle:"none",color:"#000",alpha:1};},_left:0,_right:0,_top:0,_bottom:0,initializer:function(){this._xcoords=[0];this._ycoords=[0];this.get("stroke");this.get("fill");this._addListeners();var f=this.get("node");f.setAttribute("width",this.get("width"));f.setAttribute("height",this.get("height"));this._draw();},_getNode:function(){var f=e.config.doc.createElement("canvas"),g=this.get("id");this._context=f.getContext("2d");f.setAttribute("class","yui3-"+this.name);f.setAttribute("id",g);g="#"+g;e.on("mousedown",e.bind(this._nodeEventDispatcher,this),g);e.on("mouseup",e.bind(this._nodeEventDispatcher,this),g);e.on("mouseover",e.bind(this._nodeEventDispatcher,this),g);e.on("mousemove",e.bind(this._nodeEventDispatcher,this),g);e.on("mouseout",e.bind(this._nodeEventDispatcher,this),g);e.on("mouseenter",e.bind(this._nodeEventDispatcher,this),g);e.on("mouseleave",e.bind(this._nodeEventDispatcher,this),g);e.on("click",e.bind(this._nodeEventDispatcher,this),g);return f;},_nodeEventDispatcher:function(f){f.preventDefault();this.fire(f.type,f);},_addListeners:function(){this.after("strokeChange",this._updateHandler);this.after("fillChange",this._updateHandler);this.after("widthChange",this._updateHandler);this.after("heightChange",this._updateHandler);},_setStrokeProps:function(l){var g=l.color,j=l.weight,k=l.alpha,i=l.linejoin||"round",h=l.linecap||"butt",f=l.dashstyle;this._miterlimit=null;this._dashstyle=(f&&e.Lang.isArray(f)&&f.length>1)?f:null;this._strokeWeight=j;if(j){this._stroke=1;}else{this._stroke=0;}if(k){this._strokeStyle=this._2RGBA(g,k);}else{this._strokeStyle=g;}this._linecap=h;if(i=="round"||i=="square"){this._linejoin=i;}else{i=parseInt(i,10);if(e.Lang.isNumber(i)){this._miterlimit=Math.max(i,1);this._linejoin="miter";}}},_setFillProps:function(j){var h=e.Lang.isNumber,f=j.color,g,i=j.type;if(i=="linear"||i=="radial"){this._fillType=i;}else{if(f){g=j.alpha;if(h(g)){g=Math.max(0,Math.min(1,g));f=this._2RGBA(f,g);}else{f=this._2RGB(f);}this._fillColor=f;this._fillType="solid";}else{this._fillColor=null;}}},translate:function(f,h){var g="translate("+f+"px, "+h+"px)";this._updateTransform("translate",/translate\(.*\)/,g);},skewX:function(f){},skewY:function(f){},_rotation:0,rotate:function(g){var f="rotate("+g+"deg)";this._rotation=g;
this._updateTransform("rotate",/rotate\(.*\)/,f);},_transformOrigin:function(f,h){var g=this.get("node");g.style.MozTransformOrigin=(100*f)+"% "+(100*h)+"%";},scale:function(f){},matrix:function(h,g,l,k,j,i){},_updateTransform:function(h,k,j){var i=this.get("node"),g=i.style.MozTransform||i.style.webkitTransform||i.style.msTransform||i.style.OTransform,f=this.get("transformOrigin");if(g&&g.length>0){if(g.indexOf(h)>-1){g=g.replace(k,j);}else{g+=" "+j;}}else{g=j;}f=(100*f[0])+"% "+(100*f[1])+"%";i.style.MozTransformOrigin=f;i.style.webkitTransformOrigin=f;i.style.msTransformOrigin=f;i.style.OTransformOrigin=f;i.style.MozTransform=g;i.style.webkitTransform=g;i.style.msTransform=g;i.style.OTransform=g;},_updateHandler:function(f){this._draw();},_draw:function(){this._paint();},_paint:function(){if(!this._methods){return;}var l=this.get("node"),s=this.get("width")||this._width,p=this.get("height")||this._height,g=this._context,m=[],k=this._methods.concat(),o=0,n,f,r,q=0;this.clear();if(this._methods){q=k.length;if(!q||q<1){return;}for(;o<q;++o){m[o]=k[o].concat();r=m[o];for(n=1;n<r.length;++n){if(n%2===0){r[n]=r[n]-this._top;}else{r[n]=r[n]-this._left;}}}l.setAttribute("width",s);l.setAttribute("height",p);g.beginPath();for(o=0;o<q;++o){r=m[o];if(r&&r.length>0){f=r.shift();if(f){if(f&&f=="lineTo"&&this._dashstyle){r.unshift(this._xcoords[o]-this._left,this._ycoords[o]-this._top);this._drawDashedLine.apply(this,r);}else{g[f].apply(g,r);}}}}if(this._fillType){if(this._fillType=="linear"){g.fillStyle=this._getLinearGradient();}else{if(this._fillType=="radial"){g.fillStyle=this._getRadialGradient();}else{g.fillStyle=this._fillColor;}}g.closePath();g.fill();}if(this._stroke){if(this._strokeWeight){g.lineWidth=this._strokeWeight;}g.lineCap=this._linecap;g.lineJoin=this._linejoin;if(this._miterlimit){g.miterLimit=this._miterlimit;}g.strokeStyle=this._strokeStyle;g.stroke();}this._drawingComplete=true;this._clearAndUpdateCoords();this._updateNodePosition();this._methods=k;}},_drawDashedLine:function(p,v,f,s){var g=this._context,t=this._dashstyle[0],r=this._dashstyle[1],j=t+r,m=f-p,q=s-v,u=Math.sqrt(Math.pow(m,2)+Math.pow(q,2)),k=Math.floor(Math.abs(u/j)),h=Math.atan2(q,m),o=p,n=v,l;m=Math.cos(h)*j;q=Math.sin(h)*j;for(l=0;l<k;++l){g.moveTo(o,n);g.lineTo(o+Math.cos(h)*t,n+Math.sin(h)*t);o+=m;n+=q;}g.moveTo(o,n);u=Math.sqrt((f-o)*(f-o)+(s-n)*(s-n));if(u>t){g.lineTo(o+Math.cos(h)*t,n+Math.sin(h)*t);}else{if(u>0){g.lineTo(o+Math.cos(h)*u,n+Math.sin(h)*u);}}g.moveTo(f,s);},clear:function(){var f=this.get("width"),g=this.get("height");this._initProps();this._context.clearRect(0,0,f,g);return this;}},{ATTRS:{transformOrigin:{valueFn:function(){return[0.5,0.5];}},rotation:{setter:function(f){this.rotate(f);},getter:function(){return this._rotation;}},node:{readOnly:true,valueFn:"_getNode"},id:{valueFn:function(){return e.guid();}},width:{},height:{},x:{value:0,setter:function(g){var f=this.get("node");f.style.left=(g+this._left)+"px";return g;}},y:{value:0,setter:function(g){var f=this.get("node");f.style.top=(g+this._top)+"px";return g;}},visible:{value:true,setter:function(g){var f=g?"visible":"hidden";this.get("node").style.visibility=f;return g;}},fill:{valueFn:"_getDefaultFill",setter:function(h){var g,f=this.get("fill")||this._getDefaultFill();g=(h)?e.merge(f,h):null;if(g&&g.color){if(g.color===undefined||g.color=="none"){g.color=null;}}this._setFillProps(g);return g;}},stroke:{valueFn:"_getDefaultStroke",setter:function(g){var f=this.get("stroke")||this._getDefaultStroke();g=(g)?e.merge(f,g):null;this._setStrokeProps(g);return g;}},autoSize:{value:false},pointerEvents:{value:"visiblePainted"},graphic:{}}});e.Path=e.Base.create("path",e.Shape,[],{_type:"path",_addListeners:function(){},_draw:function(){this._paint();},end:function(){this._draw();}},{ATTRS:{width:{getter:function(){return this._width;},setter:function(f){this._width=f;return f;}},height:{getter:function(){return this._height;},setter:function(f){this._height=f;return f;}},path:{getter:function(){return this._path;},setter:function(f){this._path=f;return f;}}}});e.Rect=e.Base.create("rect",e.Shape,[],{_type:"rect",_draw:function(){this.clear();var f=this.get("x"),j=this.get("y"),g=this.get("width"),i=this.get("height");this.drawRect(f,j,g,i);this._paint();}});e.Ellipse=e.Base.create("ellipse",e.Shape,[],{_type:"ellipse",_draw:function(){var f=this.get("width"),g=this.get("height");this.drawEllipse(0,0,f,g);this._paint();}});e.Circle=e.Base.create("circle",e.Base,[e.Shape],{_type:"circle",_draw:function(){var f=this.get("radius");if(f){this.drawCircle(0,0,f);this._paint();}},_addListeners:function(){this.after("radiusChange",this._updateHandler);e.Shape.prototype._addListeners.apply(this,arguments);}},{ATTRS:{width:{readOnly:true,getter:function(){return this.get("radius")*2;}},height:{readOnly:true,getter:function(){return this.get("radius")*2;}},radius:{lazyAdd:false,setter:function(h){var f=this.get("node"),g=h*2;f.setAttribute("width",g);f.setAttribute("height",g);return h;}}}});},"@VERSION@",{requires:["dom","event-custom","base","graphics"],skinnable:false});